---
- name: "Editor tools: ensure nvim plugins"
  ansible.builtin.git:
    repo: https://github.com/{{ item.repo }}
    dest: ~/.local/share/nvim/site/pack/plugins/{{ item.folder }}/{{ item.name | default(item.repo) | basename }}
    single_branch: true
    depth: 10
    version: "{{ item.version | default('HEAD') }}"
    force: true
  async: 1000
  poll: 0
  loop:
    - { folder: start, repo: stevearc/oil.nvim, name: oil }
    - { folder: start, repo: ibhagwan/fzf-lua }
    - { folder: start, repo: kevinhwang91/promise-async } # use `typings/?.lua` on .luarc.json
    - { folder: start, repo: nvim-tree/nvim-web-devicons }
    - { folder: start, repo: neoclide/coc.nvim, version: release }
    - { folder: start, repo: stevearc/overseer.nvim, name: overseer }
    - { folder: start, repo: kevinhwang91/nvim-treesitter }
    - { folder: start, repo: nvim-treesitter/nvim-treesitter-context }
    - { folder: start, repo: nvim-treesitter/nvim-treesitter-textobjects }
    - { folder: start, repo: dense-analysis/ale }
    - { folder: start, repo: FabijanZulj/blame.nvim }
    - { folder: start, repo: stevearc/conform.nvim }
    - { folder: start, repo: sindrets/diffview.nvim }
    - { folder: start, repo: lewis6991/gitsigns.nvim }
    - { folder: start, repo: LeonHeidelbach/trailblazer.nvim, name: trailblazer }
    - { folder: start, repo: tpope/vim-sleuth }
    - { folder: start, repo: mfussenegger/nvim-dap, name: dap }
    - { folder: start, repo: theHamsta/nvim-dap-virtual-text }
    - { folder: start, repo: rebelot/heirline.nvim }
    - { folder: start, repo: mbbill/undotree }
    - { folder: start, repo: stevearc/resession.nvim, name: resession }
    - { folder: start, repo: refractalize/oil-git-status.nvim }
    - { folder: start, repo: p00f/clangd_extensions.nvim }
    - { folder: start, repo: stevearc/quicker.nvim, name: quicker }
    - { folder: start, repo: kevinhwang91/nvim-fundo, name: fundo }
    - { folder: start, repo: tpope/vim-rsi } # https://vi.stackexchange.com/a/6041
    - { folder: start, repo: wellle/tmux-complete.vim }
    - { folder: start, repo: stevearc/aerial.nvim }
    - { folder: opt, repo: jbyuki/one-small-step-for-vimkind, name: osv }
    - { folder: opt, repo: Robitx/gp.nvim, name: gp }

- name: "Editor tools: clone universal ctags"
  ansible.builtin.git: 
    repo: https://github.com/universal-ctags/ctags.git
    dest: ~/repos/ctags
    depth: 1

- name: "Editor tools: ensure universal ctags"
  ansible.builtin.shell: |
    ./autogen.sh
    ./configure --prefix="$HOME/.local"
    make
    make install
  args:
    chdir: ~/repos/ctags
    creates: ~/.local/bin/ctags
